<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(25)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(25) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(25) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(25) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기 | Just the Docs Template</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A starter template for a Jeykll site using the Just the Docs theme!" /> <meta property="og:description" content="A starter template for a Jeykll site using the Just the Docs theme!" /> <link rel="canonical" href="http://0.0.0.0:4000/docs/02_Tech/CICD/SAM/java-sam-lambda" /> <meta property="og:url" content="http://0.0.0.0:4000/docs/02_Tech/CICD/SAM/java-sam-lambda" /> <meta property="og:site_name" content="Just the Docs Template" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A starter template for a Jeykll site using the Just the Docs theme!","headline":"2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기","url":"http://0.0.0.0:4000/docs/02_Tech/CICD/SAM/java-sam-lambda"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Just the Docs Template </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/docs/00_Portfolio/portfolio.html" class="nav-list-link">Portfolio</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Languages category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/01_Languages" class="nav-list-link">Languages</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Java category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/01_languages/Java" class="nav-list-link">Java</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/01_languages/Java/Security6" class="nav-list-link">Security6</a> </li><li class="nav-list-item"> <a href="/docs/01_languages/Java/Security6" class="nav-list-link">Security6</a> </li></ul></li><li class="nav-list-item"><a href="/docs/01_languages/Markdown" class="nav-list-link">Markdown</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in TypeScript category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/01_languages/TypeScript" class="nav-list-link">TypeScript</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/01_Language/TypeScript/AwsCloudScape/awscloudscape" class="nav-list-link">AWS CloudScape Component</a> </li><li class="nav-list-item"> <a href="/docs/01_Language/TypeScript/AwsCloudScape/nextjs/learn-next-js" class="nav-list-link">Next.js</a> </li><li class="nav-list-item"> <a href="/docs/01_Language/TypeScript/AwsCloudScape/nextjs" class="nav-list-link">Next.js</a> </li><li class="nav-list-item"> <a href="/docs/01_Language/TypeScript/AwsCloudScape/nextjs/learn-next-js" class="nav-list-link">Next.js</a> </li><li class="nav-list-item"> <a href="/docs/01_Language/TypeScript/AwsCloudScape/react" class="nav-list-link">React</a> </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tech category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech" class="nav-list-link">Tech</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in InteliJ category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech/InteliJ" class="nav-list-link">InteliJ</a><ul class="nav-list"></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in AWS category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech/AWS" class="nav-list-link">AWS</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudFrontFunction" class="nav-list-link">1. CloudFront Function vs Lambda@Edge 비교</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ECS/ecs-cluster-create" class="nav-list-link">1. ECS 구축하기</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ECS" class="nav-list-link">1. ECS</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/Lambda@Edge" class="nav-list-link">1. Lambda@Edge 와 JWT Web Tokens</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/Lambda@Edge" class="nav-list-link">1. Lambda@Edge 와 JWT Web Tokens</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ECS" class="nav-list-link">1. Network</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudWatch/cloudwatch-alarm" class="nav-list-link">2. Cloud Watch Alarm</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudWatch" class="nav-list-link">2. CloudWatch</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ECS/ecs-capacity-provider" class="nav-list-link">2. ECS 용량공급자</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/APIGateway/RESTAPIGateway" class="nav-list-link">2. Cloud Watch Alarm</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/SAM" class="nav-list-link">2. SAM</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Terramate" class="nav-list-link">2. Terramate</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ElasticSearch" class="nav-list-link">3. Elastic Search</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/EventBridge" class="nav-list-link">3. EventBridge</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudFront/Image-Resizing-S3-CF/image-resizing-s3-cf" class="nav-list-link">2. AWS S3, Lambda, API Gateway를 활용한 실시간 이미지 리사이징 솔루션</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/APIGateway/RESTAPIGateway/Image-Resizing-S3" class="nav-list-link">2. AWS S3, Lambda, API Gateway를 활용한 실시간 이미지 리사이징 솔루션</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/APIGateway" class="nav-list-link">5. API Gateway</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudFront" class="nav-list-link">5. Amazon CloudFront</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudFront" class="nav-list-link">5. Amazon CloudFront</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/CloudShell" class="nav-list-link">5. CloudShell</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/ElasticCache" class="nav-list-link">5. Elastic Cache</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/AWS/APIGateway/HTTPAPIGateway" class="nav-list-link">6. HTTP API Gateway</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in CICD category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech/CICD" class="nav-list-link">CICD</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/02_Tech/InteliJ/Java" class="nav-list-link">1. Java</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins" class="nav-list-link">1. Jenkins</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-installation" class="nav-list-link">1-1. AWS EC2에서 Docker를 사용하여 Jenkins 배포하기</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-checkout-scm" class="nav-list-link">1-3. jenkins checkout</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-jcasc-installation" class="nav-list-link">1-2 Jenkins 설치하기 with JCASC</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Jenkins/jenkins-notification-teams" class="nav-list-link">1-3 Teams 배포 승인 메세지</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CircleCI" class="nav-list-link">2. CircleCI</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CodePipeline" class="nav-list-link">2. CodePipeline</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-app" class="nav-list-link">2-1. TypeScript CDK로 재사용 가능한 모듈 구조 작성하기 (1편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-construct" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - Construct (4편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-context" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - App, Context (2편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-pipeline-pattern" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - pipeline (5편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-pipeline-pattern" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - pipeline (5편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-stack-advanced" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - Stack Advanced (5편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-stack-advanced" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - Stack Advanced (5편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-stack-advanced" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - Stack Advanced (5편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK/cdk-module-stack" class="nav-list-link">2-1. TypeScript CDK로 재사용가능한 모듈 구조 작성하기 - Stack (3편)</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CodePipeline/codepipeline-sam-lambda" class="nav-list-link">2-1. AWS CodePipeline을 이용해 SAM으로 Lambda 배포하기</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/SAM/java-sam-lambda" class="nav-list-link">2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/Bamboo" class="nav-list-link">3. Bamboo</a> </li><li class="nav-list-item"> <a href="/docs/02_Tech/CICD/CDK" class="nav-list-link">6. CDK</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in CKA category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech/IAC" class="nav-list-link">CKA</a><ul class="nav-list"></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in IAC category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/02_Tech/IAC" class="nav-list-link">IAC</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Project category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/03_Project" class="nav-list-link">Project</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/03_Project/Project_1_gitblog" class="nav-list-link">깃 블로그 만들기</a></li><li class="nav-list-item"><a href="/docs/03_Project/Project_2_ecs_pipeline" class="nav-list-link">Jenkins Pipeline - ECS</a></li><li class="nav-list-item"><a href="/docs/03_Project/Project_3_aws_exporter" class="nav-list-link">AWS Exporter Application 개발하기</a></li></ul></li><li class="nav-list-item"><a href="/" class="nav-list-link">Kimkm's 02_Tech Blog</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Just the Docs Template" aria-label="Search Just the Docs Template" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/just-the-docs/just-the-docs-template" class="site-button" > Template Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/02_Tech">Tech</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/02_Tech/CICD">CICD</a></li> <li class="breadcrumb-nav-list-item"><span>2-1. AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="aws-sam을-이용해-lambda로-java-어플리케이션-배포하기"> <a href="#aws-sam을-이용해-lambda로-java-어플리케이션-배포하기" class="anchor-heading" aria-labelledby="aws-sam을-이용해-lambda로-java-어플리케이션-배포하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기 </h1> <h2 class="no_toc no_toc text-delta" id="목차"> <a href="#목차" class="anchor-heading" aria-labelledby="목차"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 목차 </h2> <ol id="markdown-toc"> <li><a href="#aws-sam을-이용해-lambda로-java-어플리케이션-배포하기" id="markdown-toc-aws-sam을-이용해-lambda로-java-어플리케이션-배포하기">AWS SAM을 이용해 Lambda로 JAVA 어플리케이션 배포하기</a> <ol> <li><a href="#글을-쓴-배경" id="markdown-toc-글을-쓴-배경">글을 쓴 배경</a></li> <li><a href="#글-요약" id="markdown-toc-글-요약">글 요약</a></li> <li><a href="#시작하기-전" id="markdown-toc-시작하기-전">시작하기 전</a></li> <li><a href="#1-aws-sam과-aws-lambda-소개" id="markdown-toc-1-aws-sam과-aws-lambda-소개">1. AWS SAM과 AWS Lambda 소개</a></li> <li><a href="#2-서버리스-어플리케이션-예제" id="markdown-toc-2-서버리스-어플리케이션-예제">2. 서버리스 어플리케이션 예제</a> <ol> <li><a href="#21-function-code" id="markdown-toc-21-function-code">2.1 function code</a></li> <li><a href="#22-function-code-상세-설명" id="markdown-toc-22-function-code-상세-설명">2.2 function code 상세 설명</a></li> </ol> </li> <li><a href="#3-aws-sam을-이용한-java-application-빌드-및-배포" id="markdown-toc-3-aws-sam을-이용한-java-application-빌드-및-배포">3. AWS SAM을 이용한 Java Application 빌드 및 배포</a> <ol> <li><a href="#31-template-code" id="markdown-toc-31-template-code">3.1 template code</a></li> <li><a href="#32-sam-template의-기본-구성" id="markdown-toc-32-sam-template의-기본-구성">3.2 SAM Template의 기본 구성</a> <ol> <li><a href="#321-표준-빌드-방식" id="markdown-toc-321-표준-빌드-방식">3.2.1 표준 빌드 방식</a></li> <li><a href="#322-makefile을-이용한-커스텀-빌드-설정" id="markdown-toc-322-makefile을-이용한-커스텀-빌드-설정">3.2.2 Makefile을 이용한 커스텀 빌드 설정</a></li> <li><a href="#33-lambda-layer를-통한-의존성-관리" id="markdown-toc-33-lambda-layer를-통한-의존성-관리">3.3 Lambda Layer를 통한 의존성 관리</a></li> <li><a href="#34-pomxml" id="markdown-toc-34-pomxml">3.4 pom.xml</a> <ol> <li><a href="#341-functionpomxml" id="markdown-toc-341-functionpomxml">3.4.1 function/pom.xml</a></li> <li><a href="#343-layerpomxml" id="markdown-toc-343-layerpomxml">3.4.3 layer/pom.xml</a></li> <li><a href="#344-pomxml-주요-부분-상세-설명" id="markdown-toc-344-pomxml-주요-부분-상세-설명">3.4.4 pom.xml 주요 부분 상세 설명</a></li> </ol> </li> </ol> </li> </ol> </li> <li><a href="#5-codebuild-이용한-cicd-구성" id="markdown-toc-5-codebuild-이용한-cicd-구성">5. CodeBuild 이용한 CI/CD 구성</a> <ol> <li><a href="#51-buildspecyml" id="markdown-toc-51-buildspecyml">5.1 buildspec.yml</a></li> </ol> </li> <li><a href="#5-lambda-배포-확인" id="markdown-toc-5-lambda-배포-확인">5. Lambda 배포 확인</a></li> </ol> </li> </ol><hr /> <h2 id="글을-쓴-배경"> <a href="#글을-쓴-배경" class="anchor-heading" aria-labelledby="글을-쓴-배경"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 글을 쓴 배경 </h2> <p>이 글에서는 AWS SAM(Serverless Application Model)을 이용하여 Lambda로 Java 어플리케이션을 배포하는 과정을 설명합니다.</p> <h2 id="글-요약"> <a href="#글-요약" class="anchor-heading" aria-labelledby="글-요약"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 글 요약 </h2> <p>AWS SAM과 AWS CodeBuild 를 이용해 Java Application을 Lambda에 배포하고 API Gateway를 통해 Lambda를 호출하는 과정을 설명합니다.</p> <h2 id="시작하기-전"> <a href="#시작하기-전" class="anchor-heading" aria-labelledby="시작하기-전"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 시작하기 전 </h2> <ul> <li><strong>CodeBuild 빌드 환경 사용</strong>: public.ecr.aws/sam/build-java21:1.115.0-20240411212300-x86_64 (<a href="https://gallery.ecr.aws/sam/build-java21">ECR Public Gallery</a>)</li> <li><strong>Java 버전</strong>: Java 21</li> <li><strong>sam 버전</strong>: SAM CLI, version 1.108.0</li> </ul><hr /> <h2 id="1-aws-sam과-aws-lambda-소개"> <a href="#1-aws-sam과-aws-lambda-소개" class="anchor-heading" aria-labelledby="1-aws-sam과-aws-lambda-소개"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. AWS SAM과 AWS Lambda 소개 </h2> <p><strong>AWS SAM</strong></p> <p>AWS SAM은 AWS CloudFormation의 확장 프레임워크입니다. 개발자는 YAML 혹은 JSON 템플릿으로 리소스를 정의할 수 있으며, 이 템플릿은 AWS CloudFormation으로 자동 변환되어 리소스가 프로비저닝됩니다.</p> <p>SAM을 사용함으로써 개발자는 Lambda 코드의 버전 관리를 Git과 같은 형상관리 도구를 사용하여 수행할 수 있으며, Lambda 배포를 Git 레포지토리에 코드를 푸시하는 과정으로 수행할 수 있습니다.</p> <p>관련 문서 : <a href="https://docs.aws.amazon.com/ko_kr/serverless-application-model/latest/developerguide/what-is-sam.html">AWS Serverless Application Model (AWS SAM) 란 무엇입니까?</a></p> <p><strong>AWS Lambda</strong></p> <p>AWS Lambda는 코드를 서버 없이 실행할 수 있게 해주는 서비스입니다.</p> <p>관련 문서 : <a href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/welcome.html">AWS Lambda이란 무엇인가요?</a></p> <h2 id="2-서버리스-어플리케이션-예제"> <a href="#2-서버리스-어플리케이션-예제" class="anchor-heading" aria-labelledby="2-서버리스-어플리케이션-예제"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. 서버리스 어플리케이션 예제 </h2> <p>다음은 Lambda에서 사용되는 Java 함수 코드입니다</p> <h3 id="21-function-code"> <a href="#21-function-code" class="anchor-heading" aria-labelledby="21-function-code"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1 function code </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.amazonaws.services.lambda.runtime.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.amazonaws.services.lambda.runtime.LambdaLogger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.amazonaws.services.lambda.runtime.RequestHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.amazonaws.services.lambda.runtime.events.APIGatewayProxyRequestEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.amazonaws.services.lambda.runtime.events.APIGatewayProxyResponseEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.metrics.Metrics</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.tracing.Tracing</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">software</span><span class="o">.</span><span class="na">amazon</span><span class="o">.</span><span class="na">lambda</span><span class="o">.</span><span class="na">powertools</span><span class="o">.</span><span class="na">tracing</span><span class="o">.</span><span class="na">CaptureMode</span><span class="o">.</span><span class="na">DISABLED</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Handler</span> <span class="kd">implements</span> <span class="nc">RequestHandler</span><span class="o">&lt;</span><span class="nc">APIGatewayProxyRequestEvent</span><span class="o">,</span> <span class="nc">APIGatewayProxyResponseEvent</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Tracing</span><span class="o">(</span><span class="n">captureMode</span> <span class="o">=</span> <span class="no">DISABLED</span><span class="o">)</span>
    <span class="nd">@Metrics</span><span class="o">(</span><span class="n">captureColdStart</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">APIGatewayProxyResponseEvent</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="kd">final</span> <span class="nc">APIGatewayProxyRequestEvent</span> <span class="n">input</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">LambdaLogger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getLogger</span><span class="o">();</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Received request: "</span> <span class="o">+</span> <span class="n">input</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>

        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
        <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"X-Custom-Header"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>

        <span class="nc">APIGatewayProxyResponseEvent</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">APIGatewayProxyResponseEvent</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withHeaders</span><span class="o">(</span><span class="n">headers</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="nc">String</span> <span class="n">pageContents</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getPageContents</span><span class="o">(</span><span class="s">"https://checkip.amazonaws.com"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">output</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"{ \"message\": \"hello world\", \"location\": \"%s\" }"</span><span class="o">,</span> <span class="n">pageContents</span><span class="o">);</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Response body: "</span> <span class="o">+</span> <span class="n">output</span><span class="o">);</span>

            <span class="k">return</span> <span class="n">response</span>
                    <span class="o">.</span><span class="na">withStatusCode</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="n">output</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">response</span>
                    <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"{}"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">withStatusCode</span><span class="o">(</span><span class="mi">500</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Tracing</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"getPageContents"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">getPageContents</span><span class="o">(</span><span class="nc">String</span> <span class="n">address</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">url</span><span class="o">.</span><span class="na">openStream</span><span class="o">())))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">br</span><span class="o">.</span><span class="na">lines</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">lineSeparator</span><span class="o">()));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="22-function-code-상세-설명"> <a href="#22-function-code-상세-설명" class="anchor-heading" aria-labelledby="22-function-code-상세-설명"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2 function code 상세 설명 </h3> <p>이 AWS Lambda 함수는 API Gateway로부터 오는 HTTP 요청을 처리합니다. Handler 클래스에 정의된 handleRequest 메소드를 통해 이벤트를 수신하고 처리 결과를 반환합니다.</p> <p><strong>클래스 및 인터페이스 선언</strong></p> <p><code class="language-plaintext highlighter-rouge">Handler</code> 클래스는 <a href="https://github.com/aws/aws-lambda-java-libs/blob/main/aws-lambda-java-core/src/main/java/com/amazonaws/services/lambda/runtime/RequestHandler.java">RequestHandler</a> 인터페이스를 구현합니다. 이 인터페이스는 두 개의 제네릭 파라미터를 받으며, AWS Lambda에서 이벤트를 처리할 수 있도록 합니다.</p> <ul> <li><strong>RequestHandler</strong> : Lambda 함수의 로직을 구현하는 핸들러입니다.</li> <li><strong><a href="https://github.com/aws/aws-lambda-java-libs/blob/main/aws-lambda-java-events/src/main/java/com/amazonaws/services/lambda/runtime/events/APIGatewayProxyRequestEvent.java">APIGatewayProxyRequestEvent</a></strong> : API Gateway로부터 받은 HTTP 요청 데이터를 담고 있습니다.</li> <li><strong><a href="https://github.com/aws/aws-lambda-java-libs/blob/main/aws-lambda-java-events/src/main/java/com/amazonaws/services/lambda/runtime/events/APIGatewayProxyResponseEvent.java">APIGatewayProxyResponseEvent</a></strong> : 처리 결과를 API Gateway로 반환할 때 사용하는 객체입니다.</li> </ul> <p><strong>어노테이션 활용</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">@Tracing</code>: AWS X-Ray와 통합하여 Lambda 애플리케이션의 추적, 디버깅 및 최적화를 지원합니다. <code class="language-plaintext highlighter-rouge">captureMode = DISABLED</code> 설정은 자동 추적을 비활성화합니다.</li> <li><code class="language-plaintext highlighter-rouge">@Metrics</code>: 성능 메트릭을 수집하는 데 사용됩니다. <code class="language-plaintext highlighter-rouge">captureColdStart = true</code> 옵션으로 콜드 스타트 시 발생하는 지연 시간과 관련 데이터를 캡처합니다.</li> </ul> <blockquote> <p>콜드 스타트란?</p> <p>배포 후 일정 기간동안 사용되지 않아 함수가 내려간 후 다시 시작될 때 혹은 새 인스턴스로 처음 시작될 때 때 주로 발생됩니다. 이 때 지연이 발생될 수 있으며 captureColdStart 옵션은 이 지연시간을 포함한 세부정보를 기록합니다.</p> </blockquote> <p><strong>핸들러 메인 메소드</strong></p> <p><code class="language-plaintext highlighter-rouge">handleRequest</code> 메소드는 API Gateway로부터 받은 HTTP 요청을 처리하고 응답을 반환합니다. 메소드는 <code class="language-plaintext highlighter-rouge">APIGatewayProxyRequestEvent</code>와 <code class="language-plaintext highlighter-rouge">Context</code> 객체를 매개변수로 받아 실행됩니다.</p> <ul> <li>Context 객체: Lambda 실행 환경에 대한 정보를 제공하며, 로깅 등의 기능에 접근할 수 있습니다.</li> <li>LambdaLogger: 요청을 로깅하여 CloudWatch에서 확인할 수 있게 합니다.</li> <li>응답 헤더 설정: 응답에 <code class="language-plaintext highlighter-rouge">Content-Type</code>과 <code class="language-plaintext highlighter-rouge">X-Custom-Header</code>를 설정하여 응답이 JSON 형식임을 명시합니다.</li> </ul> <p><strong>외부 리소스 접근</strong></p> <p><code class="language-plaintext highlighter-rouge">getPageContents</code> 메소드: 외부 URL에서 데이터를 가져오는 기능을 수행합니다. 이 메소드는 https://checkip.amazonaws.com에서 IP 주소를 조회하며, 이 정보를 응답에 포함시킵니다.</p> <h2 id="3-aws-sam을-이용한-java-application-빌드-및-배포"> <a href="#3-aws-sam을-이용한-java-application-빌드-및-배포" class="anchor-heading" aria-labelledby="3-aws-sam을-이용한-java-application-빌드-및-배포"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. AWS SAM을 이용한 Java Application 빌드 및 배포 </h2> <p>AWS SAM은 Java 언어를 사용할 때 Maven이나 Gradle과 같은 표준 Java 빌드 도구를 자동으로 활용하여 프로젝트를 배포합니다.</p> <h3 id="31-template-code"> <a href="#31-template-code" class="anchor-heading" aria-labelledby="31-template-code"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1 template code </h3> <p>다음은 SAM 에서 Lambda 함수를 배포 할 때 사용하는 template.yaml 파일입니다.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2010-09-09'</span>
<span class="na">Transform</span><span class="pi">:</span> <span class="s">AWS::Serverless-2016-10-31</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s">A simple AWS Lambda application using Java with a Layer.</span>

<span class="na">Globals</span><span class="pi">:</span>
  <span class="na">Function</span><span class="pi">:</span>
    <span class="na">Runtime</span><span class="pi">:</span> <span class="s">java21</span>
    <span class="na">Timeout</span><span class="pi">:</span> <span class="m">10</span>  <span class="c1"># Timeout in seconds</span>
    <span class="na">MemorySize</span><span class="pi">:</span> <span class="m">512</span>
    <span class="na">Architectures</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">x86_64</span>
<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">LambdaFunctionName</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">String</span>
    <span class="na">Default</span><span class="pi">:</span> <span class="s">lmd-java-sample</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">The name of the Lambda function.</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="na">JavaFunction</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Serverless::Function</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">FunctionName</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">LambdaFunctionName</span>
      <span class="na">Handler</span><span class="pi">:</span> <span class="s">example.Handler::handleRequest</span>
      <span class="na">CodeUri</span><span class="pi">:</span> <span class="s">function/</span>
      <span class="na">SnapStart</span><span class="pi">:</span>
        <span class="na">ApplyOn</span><span class="pi">:</span> <span class="s">PublishedVersions</span>
      <span class="na">Role</span><span class="pi">:</span> <span class="s">arn:aws:iam::539666729110:role/kimkm-lambda-role</span>
      <span class="na">Layers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">JavaLayer</span>
    <span class="na">Metadata</span><span class="pi">:</span>
      <span class="na">BuildMethod</span><span class="pi">:</span> <span class="s">makefile</span>

  <span class="na">JavaLayer</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::Serverless::LayerVersion</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">LayerName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">java-dependencies"</span>
      <span class="na">Description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Java</span><span class="nv"> </span><span class="s">libraries</span><span class="nv"> </span><span class="s">required</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">lambda</span><span class="nv"> </span><span class="s">function"</span>
      <span class="na">ContentUri</span><span class="pi">:</span> <span class="s">layer/</span>
      <span class="na">RetentionPolicy</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Delete'</span>
    <span class="na">Metadata</span><span class="pi">:</span>
      <span class="na">BuildMethod</span><span class="pi">:</span> <span class="s">java21</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">JavaFunction</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Lambda</span><span class="nv"> </span><span class="s">Function</span><span class="nv"> </span><span class="s">ARN"</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">JavaFunction.Arn</span>
  <span class="na">JavaLayer</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Lambda</span><span class="nv"> </span><span class="s">Layer</span><span class="nv"> </span><span class="s">ARN"</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">JavaLayer</span>

</code></pre></div></div> <h3 id="32-sam-template의-기본-구성"> <a href="#32-sam-template의-기본-구성" class="anchor-heading" aria-labelledby="32-sam-template의-기본-구성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2 SAM Template의 기본 구성 </h3> <p>AWS SAM은 template.yaml 파일을 통해 실행되며, 본 예제 파일에서는 Lambda 함수와 관련된 설정을 정의합니다.</p> <h4 id="321-표준-빌드-방식"> <a href="#321-표준-빌드-방식" class="anchor-heading" aria-labelledby="321-표준-빌드-방식"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2.1 표준 빌드 방식 </h4> <p>AWS SAM CLI는 <code class="language-plaintext highlighter-rouge">sam build</code> 명령어를 실행할 때, 자동으로 template.yaml 파일에서 지정된 CodeUri 경로에서 Java 프로젝트의 <code class="language-plaintext highlighter-rouge">pom.xml</code> 혹은 <code class="language-plaintext highlighter-rouge">build.gradle</code> 파일을 찾아 빌드 과정을 진행합니다.</p> <ul> <li>Maven 사용 시: <code class="language-plaintext highlighter-rouge">mvn clean install</code> 명령을 사용하여 의존성을 해결하고, 실행 가능한 jar 파일을 컴파일합니다.</li> <li>Gradle 사용 시: <code class="language-plaintext highlighter-rouge">gradle build</code> 명령을 사용하여 동일한 작업을 수행합니다.</li> </ul> <p>이러한 빌드 과정은 template.yaml 파일내 있는 <code class="language-plaintext highlighter-rouge">BuildMethod: java21</code> 옵션을 통해 AWS SAM이 자동으로 처리합니다.</p> <h4 id="322-makefile을-이용한-커스텀-빌드-설정"> <a href="#322-makefile을-이용한-커스텀-빌드-설정" class="anchor-heading" aria-labelledby="322-makefile을-이용한-커스텀-빌드-설정"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2.2 Makefile을 이용한 커스텀 빌드 설정 </h4> <p>Java 애플리케이션의 경우, 특히 AWS Lambda에 배포될 때, 종종 추가적인 빌드 설정이 필요합니다. Makefile을 통해 사용자가 직접 빌드 과정을 정의할 수 있습니다.</p><pre><code class="language-Makefile">build-JavaFunction:
	mkdir -p "$(ARTIFACTS_DIR)/lib"
	mvn clean package
	cp -rf ./target/*.jar "$(ARTIFACTS_DIR)/lib/"
	rm -rf ./target
</code></pre><p>위 Makefile 스크립트는 아티팩트를 정리하고, jar 파일을 컴파일 한다음, lambda 배포를 위해 지정된 위치에 복사합니다.</p> <p>명령어에서 사용된 <code class="language-plaintext highlighter-rouge">ARTIFACTS_DIR</code>는 AWS SAM이 빌드 중에 사용하는 환경 변수로, 빌드된 파일들을 저장할 경로를 지정합니다.</p> <p>lib 폴더는 Lambda에서 지정한 Java 용 라이브러리를 저장하는데 사용하는 디렉토리 명칭입니다. 폴더 명을 바꾸면 안됩니다.</p> <h4 id="33-lambda-layer를-통한-의존성-관리"> <a href="#33-lambda-layer를-통한-의존성-관리" class="anchor-heading" aria-labelledby="33-lambda-layer를-통한-의존성-관리"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.3 Lambda Layer를 통한 의존성 관리 </h4> <p><code class="language-plaintext highlighter-rouge">AWS::Serverless::LayerVersion</code>선언은 Lambda 함수가 실행 시 필요한 의존성을 제공합니다. 이는 Lambda 환경에서 공통 의존성을 제공하여 각 함수의 패키지 크기를 줄이는 데 사용됩니다.</p> <h4 id="34-pomxml"> <a href="#34-pomxml" class="anchor-heading" aria-labelledby="34-pomxml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4 pom.xml </h4> <p>Java 빌드 과정에서 모든 소스 코드와 의존성은 하나의 jar 파일 안에 포함되어 Lambda에 배포됩니다.</p> <p>AWS Lambda에서 Maven을 이용하여 Java 함수를 구현할 때, pom.xml 파일은 Java 프로젝트의 구성을 정의하고, 필요한 라이브러리들을 관리합니다.</p> <h5 id="341-functionpomxml"> <a href="#341-functionpomxml" class="anchor-heading" aria-labelledby="341-functionpomxml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4.1 function/pom.xml </h5> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>java-function<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>java-function<span class="nt">&lt;/name&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>21<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>21<span class="nt">&lt;/maven.compiler.target&gt;</span>
        <span class="nt">&lt;aws.java.sdk.version&gt;</span>2.25.16<span class="nt">&lt;/aws.java.sdk.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencyManagement&gt;</span>
        <span class="nt">&lt;dependencies&gt;</span>
            <span class="nt">&lt;dependency&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>software.amazon.awssdk<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>bom<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>${aws.java.sdk.version}<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
            <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;/dependencies&gt;</span>
    <span class="nt">&lt;/dependencyManagement&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>java-layer<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;/dependencies&gt;</span>

<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div> <h5 id="343-layerpomxml"> <a href="#343-layerpomxml" class="anchor-heading" aria-labelledby="343-layerpomxml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4.3 layer/pom.xml </h5> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>java-layer<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>java-layer<span class="nt">&lt;/name&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>21<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>21<span class="nt">&lt;/maven.compiler.target&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.amazonaws<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>aws-lambda-java-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.groovy<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>groovy<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>4.0.15<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.amazonaws<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>aws-lambda-java-events<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.11.5<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>software.amazon.lambda<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>powertools-tracing<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.12.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>software.amazon.lambda<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>powertools-metrics<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.12.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;/dependencies&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>3.13.0<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;source&gt;</span>21<span class="nt">&lt;/source&gt;</span>
                    <span class="nt">&lt;target&gt;</span>21<span class="nt">&lt;/target&gt;</span>
                    <span class="nt">&lt;release&gt;</span>21<span class="nt">&lt;/release&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>

            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>maven-shade-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>3.5.2<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;createDependencyReducedPom&gt;</span>false<span class="nt">&lt;/createDependencyReducedPom&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>shade<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>

<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div> <h5 id="344-pomxml-주요-부분-상세-설명"> <a href="#344-pomxml-주요-부분-상세-설명" class="anchor-heading" aria-labelledby="344-pomxml-주요-부분-상세-설명"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4.4 pom.xml 주요 부분 상세 설명 </h5> <ol> <li>provided scope</li> </ol> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>java-layer<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div> <ul> <li><strong>역할</strong>: 람다 호출 시 런타임이 람다 layer에서 의존성을 제공받기 때문에 람다에 배포할 패키지에 포함시키지 않습니다.</li> <li><strong>중요성</strong>: 이 설정은 배포 패키지의 크기를 줄이는 데 큰 도움을 주어, 배포 시간과 리소스 사용을 최소화하며, Lambda 함수의 cold start 시간을 개선할 수 있습니다. 또한, 의존성 충돌을 피하는데도 도움이 됩니다.</li> </ul> <ol> <li>Maven Shade Plugin ```xml</li> </ol> <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-shade-plugin</artifactId> <version>3.5.2</version> <configuration> <createDependencyReducedPom>false</createDependencyReducedPom> </configuration> <executions> <execution> <phase>package</phase> <goals> <goal>shade</goal> </goals> </execution> </executions> </plugin> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
* **역할**: Maven 프로젝트에서 하나의 실행 가능한 jar 파일을 생성하는 데 사용됩니다. 람다 배포시 단일 실행 파일로 배포해야합니다.

## 4. samconfig.toml

SAM 프로젝트를 배포할 때 사용되는 설정 정보를 포함하는 파일입니다. 

```toml
version=0.1
[default.global.parameters]
stack_name = "common-stack"

[default.deploy.parameters]
stack_name = "stack-lmd-java-sample"
s3_bucket = "kimkmari-s3"
s3_prefix = "template/lmd-java-sample"
region = "ap-northeast-2"
confirm_changeset = false
capabilities = "CAPABILITY_IAM"

[default.build.parameters]
no_beta_features = true
</code></pre></div></div> <h2 id="5-codebuild-이용한-cicd-구성"> <a href="#5-codebuild-이용한-cicd-구성" class="anchor-heading" aria-labelledby="5-codebuild-이용한-cicd-구성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. CodeBuild 이용한 CI/CD 구성 </h2> <p>codebuild를 이용해 SAM CLI를 통해 Lambda를 배포할 수 있습니다.</p> <h3 id="51-buildspecyml"> <a href="#51-buildspecyml" class="anchor-heading" aria-labelledby="51-buildspecyml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.1 buildspec.yml </h3> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="m">0.2</span>

<span class="na">env</span><span class="pi">:</span>
  <span class="na">shell</span><span class="pi">:</span> <span class="s">bash</span>

<span class="na">phases</span><span class="pi">:</span>
  <span class="na">install</span><span class="pi">:</span>
    <span class="na">commands</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">java -version</span>
      <span class="pi">-</span> <span class="s">cat /etc/os-release</span>
      <span class="pi">-</span> <span class="s">sam --version</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">commands</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">echo Build started on `date`</span>
      <span class="pi">-</span> <span class="s">ls -alh ./</span>
      <span class="pi">-</span> <span class="s">sam build</span>
      <span class="pi">-</span> <span class="s">sam deploy --no-progressbar --no-fail-on-empty-changeset</span>
</code></pre></div></div> <h2 id="5-lambda-배포-확인"> <a href="#5-lambda-배포-확인" class="anchor-heading" aria-labelledby="5-lambda-배포-확인"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Lambda 배포 확인 </h2> <p>codebuild project 수행 확인</p> <p><img src="img-1.png" alt="img-1.png" /></p> <p>api gateway를 이용한 lambda 호출</p> <p><img src="img-2.png" alt="img-2.png" /></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
